{"version":3,"file":"CreditsPanel-YdwU-guQ.js","sources":["../../src/components/dialog/content/setting/CreditsPanel.vue"],"sourcesContent":["<template>\n  <TabPanel value=\"Credits\" class=\"credits-container h-full\">\n    <div class=\"flex flex-col h-full\">\n      <h2 class=\"text-2xl font-bold mb-2\">\n        {{ $t('credits.credits') }}\n      </h2>\n\n      <Divider />\n\n      <div class=\"flex flex-col gap-2\">\n        <h3 class=\"text-sm font-medium text-muted\">\n          {{ $t('credits.yourCreditBalance') }}\n        </h3>\n        <div class=\"flex justify-between items-center\">\n          <UserCredit text-class=\"text-3xl font-bold\" />\n          <Skeleton v-if=\"loading\" width=\"2rem\" height=\"2rem\" />\n          <Button\n            v-else\n            :label=\"$t('credits.purchaseCredits')\"\n            :loading=\"loading\"\n            @click=\"handlePurchaseCreditsClick\"\n          />\n        </div>\n        <div class=\"flex flex-row items-center\">\n          <Skeleton\n            v-if=\"balanceLoading\"\n            width=\"12rem\"\n            height=\"1rem\"\n            class=\"text-xs\"\n          />\n          <div v-else-if=\"formattedLastUpdateTime\" class=\"text-xs text-muted\">\n            {{ $t('credits.lastUpdated') }}: {{ formattedLastUpdateTime }}\n          </div>\n          <Button\n            icon=\"pi pi-refresh\"\n            text\n            size=\"small\"\n            severity=\"secondary\"\n            @click=\"() => authActions.fetchBalance()\"\n          />\n        </div>\n      </div>\n\n      <div class=\"flex justify-between items-center mt-8\">\n        <Button\n          :label=\"$t('credits.invoiceHistory')\"\n          text\n          severity=\"secondary\"\n          icon=\"pi pi-arrow-up-right\"\n          :loading=\"loading\"\n          @click=\"handleCreditsHistoryClick\"\n        />\n      </div>\n\n      <template v-if=\"creditHistory.length > 0\">\n        <div class=\"flex-grow\">\n          <DataTable :value=\"creditHistory\" :show-headers=\"false\">\n            <Column field=\"title\" :header=\"$t('g.name')\">\n              <template #body=\"{ data }\">\n                <div class=\"text-sm font-medium\">{{ data.title }}</div>\n                <div class=\"text-xs text-muted\">{{ data.timestamp }}</div>\n              </template>\n            </Column>\n            <Column field=\"amount\" :header=\"$t('g.amount')\">\n              <template #body=\"{ data }\">\n                <div\n                  :class=\"[\n                    'text-base font-medium text-center',\n                    data.isPositive ? 'text-sky-500' : 'text-red-400'\n                  ]\"\n                >\n                  {{ data.isPositive ? '+' : '-' }}${{\n                    formatMetronomeCurrency(data.amount, 'usd')\n                  }}\n                </div>\n              </template>\n            </Column>\n          </DataTable>\n        </div>\n      </template>\n\n      <Divider />\n\n      <div class=\"flex flex-row gap-2\">\n        <Button\n          :label=\"$t('credits.faqs')\"\n          text\n          severity=\"secondary\"\n          icon=\"pi pi-question-circle\"\n          @click=\"handleFaqClick\"\n        />\n        <Button\n          :label=\"$t('credits.messageSupport')\"\n          text\n          severity=\"secondary\"\n          icon=\"pi pi-comments\"\n          @click=\"handleMessageSupport\"\n        />\n      </div>\n    </div>\n  </TabPanel>\n</template>\n\n<script setup lang=\"ts\">\nimport Button from 'primevue/button'\nimport Column from 'primevue/column'\nimport DataTable from 'primevue/datatable'\nimport Divider from 'primevue/divider'\nimport Skeleton from 'primevue/skeleton'\nimport TabPanel from 'primevue/tabpanel'\nimport { computed, ref } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nimport UserCredit from '@/components/common/UserCredit.vue'\nimport { useFirebaseAuthActions } from '@/composables/auth/useFirebaseAuthActions'\nimport { useDialogService } from '@/services/dialogService'\nimport { useFirebaseAuthStore } from '@/stores/firebaseAuthStore'\nimport { formatMetronomeCurrency } from '@/utils/formatUtil'\n\ninterface CreditHistoryItemData {\n  title: string\n  timestamp: string\n  amount: number\n  isPositive: boolean\n}\n\nconst { t } = useI18n()\nconst dialogService = useDialogService()\nconst authStore = useFirebaseAuthStore()\nconst authActions = useFirebaseAuthActions()\nconst loading = computed(() => authStore.loading)\nconst balanceLoading = computed(() => authStore.isFetchingBalance)\n\nconst formattedLastUpdateTime = computed(() =>\n  authStore.lastBalanceUpdateTime\n    ? authStore.lastBalanceUpdateTime.toLocaleString()\n    : ''\n)\n\nconst handlePurchaseCreditsClick = () => {\n  dialogService.showTopUpCreditsDialog()\n}\n\nconst handleCreditsHistoryClick = async () => {\n  await authActions.accessBillingPortal()\n}\n\nconst handleMessageSupport = () => {\n  dialogService.showIssueReportDialog({\n    title: t('issueReport.contactSupportTitle'),\n    subtitle: t('issueReport.contactSupportDescription'),\n    panelProps: {\n      errorType: 'BillingSupport',\n      defaultFields: ['Workflow', 'Logs', 'SystemStats', 'Settings']\n    }\n  })\n}\n\nconst handleFaqClick = () => {\n  window.open('https://docs.comfy.org/tutorials/api-nodes/faq', '_blank')\n}\n\nconst creditHistory = ref<CreditHistoryItemData[]>([])\n</script>\n"],"names":["_createBlock","_unref","TabPanel","_createElementVNode","_toDisplayString","$t","_createVNode","Divider","UserCredit","Skeleton","Button","_openBlock","_createElementBlock","DataTable","Column","_withCtx","_normalizeClass"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA8HM,UAAA,EAAE,EAAE,IAAI,QAAQ;AACtB,UAAM,gBAAgB,iBAAiB;AACvC,UAAM,YAAY,qBAAqB;AACvC,UAAM,cAAc,uBAAuB;AAC3C,UAAM,UAAU,SAAS,MAAM,UAAU,OAAO;AAChD,UAAM,iBAAiB,SAAS,MAAM,UAAU,iBAAiB;AAEjE,UAAM,0BAA0B;AAAA,MAAS,MACvC,UAAU,wBACN,UAAU,sBAAsB,mBAChC;AAAA,IACN;AAEA,UAAM,6BAA6B,6BAAM;AACvC,oBAAc,uBAAuB;AAAA,IACvC,GAFmC;AAInC,UAAM,4BAA4B,mCAAY;AAC5C,YAAM,YAAY,oBAAoB;AAAA,IACxC,GAFkC;AAIlC,UAAM,uBAAuB,6BAAM;AACjC,oBAAc,sBAAsB;AAAA,QAClC,OAAO,EAAE,iCAAiC;AAAA,QAC1C,UAAU,EAAE,uCAAuC;AAAA,QACnD,YAAY;AAAA,UACV,WAAW;AAAA,UACX,eAAe,CAAC,YAAY,QAAQ,eAAe,UAAU;AAAA,QAAA;AAAA,MAC/D,CACD;AAAA,IACH,GAT6B;AAW7B,UAAM,iBAAiB,6BAAM;AACpB,aAAA,KAAK,kDAAkD,QAAQ;AAAA,IACxE,GAFuB;AAIjB,UAAA,gBAAgB,IAA6B,EAAE;;0BAjKnDA,YAmGWC,MAAAC,QAAA,GAAA;AAAA,QAnGD,OAAM;AAAA,QAAU,OAAM;AAAA,MAAA;yBAC9B,MAiGM;AAAA,UAjGNC,gBAiGM,OAjGN,YAiGM;AAAA,YAhGJA,gBAEK,MAFL,YAEKC,gBADAC,KAAE,GAAA,iBAAA,CAAA,GAAA,CAAA;AAAA,YAGPC,YAAWL,MAAAM,MAAA,CAAA;AAAA,YAEXJ,gBAgCM,OAhCN,YAgCM;AAAA,cA/BJA,gBAEK,MAFL,YAEKC,gBADAC,KAAE,GAAA,2BAAA,CAAA,GAAA,CAAA;AAAA,cAEPF,gBASM,OATN,YASM;AAAA,gBARJG,YAA8CE,aAAA,EAAlC,cAAW,sBAAoB;AAAA,gBAC3B,QAAO,sBAAvBR,YAAsDC,MAAAQ,QAAA,GAAA;AAAA;kBAA7B,OAAM;AAAA,kBAAO,QAAO;AAAA,oCAC7CT,YAKEC,MAAAS,QAAA,GAAA;AAAA;kBAHC,OAAOL,KAAE,GAAA,yBAAA;AAAA,kBACT,SAAS,QAAO;AAAA,kBAChB,SAAO;AAAA;;cAGZF,gBAiBM,OAjBN,YAiBM;AAAA,gBAfI,eAAc,sBADtBH,YAKEC,MAAAQ,QAAA,GAAA;AAAA;kBAHA,OAAM;AAAA,kBACN,QAAO;AAAA,kBACP,OAAM;AAAA,gBAAA,MAEQ,wBAAuB,SAAvCE,aAAAC,mBAEM,OAFN,YAEMR,gBADDC,QAA4B,qBAAA,CAAA,IAAA,uBAAK,wBAAuB,KAAA,GAAA,CAAA;gBAE7DC,YAMEL,MAAAS,QAAA,GAAA;AAAA,kBALA,MAAK;AAAA,kBACL,MAAA;AAAA,kBACA,MAAK;AAAA,kBACL,UAAS;AAAA,kBACR,SAAK,OAAA,CAAA,MAAA,OAAA,CAAA,IAAA,MAAQT,MAAW,WAAA,EAAC,aAAY;AAAA;;;YAK5CE,gBASM,OATN,YASM;AAAA,cARJG,YAOEL,MAAAS,QAAA,GAAA;AAAA,gBANC,OAAOL,KAAE,GAAA,wBAAA;AAAA,gBACV,MAAA;AAAA,gBACA,UAAS;AAAA,gBACT,MAAK;AAAA,gBACJ,SAAS,QAAO;AAAA,gBAChB,SAAO;AAAA;;YAII,cAAA,MAAc,SAAM,KAClCM,aAAAC,mBAuBM,OAvBN,YAuBM;AAAA,cAtBJN,YAqBYL,MAAAY,QAAA,GAAA;AAAA,gBArBA,OAAO,cAAa;AAAA,gBAAG,gBAAc;AAAA,cAAA;iCAC/C,MAKS;AAAA,kBALTP,YAKSL,MAAAa,QAAA,GAAA;AAAA,oBALD,OAAM;AAAA,oBAAS,QAAQT,KAAE,GAAA,QAAA;AAAA,kBAAA;oBACpB,MAAIU,QACb,CAAuD,EADtC,WAAI;AAAA,sBACrBZ,gBAAuD,OAAvD,aAAoCC,gBAAA,KAAK,KAAK,GAAA,CAAA;AAAA,sBAC9CD,gBAA0D,OAA1D,aAAmCC,gBAAA,KAAK,SAAS,GAAA,CAAA;AAAA,oBAAA;;;kBAGrDE,YAaSL,MAAAa,QAAA,GAAA;AAAA,oBAbD,OAAM;AAAA,oBAAU,QAAQT,KAAE,GAAA,UAAA;AAAA,kBAAA;oBACrB,MAAIU,QACb,CASM,EAVW,WAAI;AAAA,sBACrBZ,gBASM,OAAA;AAAA,wBARH,OAAKa,eAAA;AAAA;0BAAiF,KAAK,aAAU,iBAAA;AAAA;yCAKnG,KAAK,aAAyB,MAAA,GAAA,IAAA,sBAC/Bf,MAAuB,uBAAA,EAAC,KAAK,QAAM,KAAA,CAAA,GAAA,CAAA;AAAA,oBAAA;;;;;;;YASjDK,YAAWL,MAAAM,MAAA,CAAA;AAAA,YAEXJ,gBAeM,OAfN,aAeM;AAAA,cAdJG,YAMEL,MAAAS,QAAA,GAAA;AAAA,gBALC,OAAOL,KAAE,GAAA,cAAA;AAAA,gBACV,MAAA;AAAA,gBACA,UAAS;AAAA,gBACT,MAAK;AAAA,gBACJ,SAAO;AAAA;cAEVC,YAMEL,MAAAS,QAAA,GAAA;AAAA,gBALC,OAAOL,KAAE,GAAA,wBAAA;AAAA,gBACV,MAAA;AAAA,gBACA,UAAS;AAAA,gBACT,MAAK;AAAA,gBACJ,SAAO;AAAA,cAAA;;;;;;;;;"}